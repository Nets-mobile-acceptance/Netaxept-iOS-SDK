<!DOCTYPE html>
<html lang="en">
  <head>
    <title>2. Saving a card  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="2. Saving a card  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          Pia Docs
        </a>
         (68% documented)
      </p>
    
      <div class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </div>
    
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">Pia Reference</a>
      <img class="carat" src="img/carat.png" alt=""/>
      2. Saving a card  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="0-getting-started.html">0. Getting started</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="11-basic-payment-flow.html">1.1. Basic payment flow</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="12-easy-one-click-payment-flow.html">1.2. Easy (one click) payment flow</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="13-recurring-payments.html">1.3. Recurring payments</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="14-payment-without-security-code.html">1.4. Payment Without Security Code</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="15-s-business-card.html">1.5. S-Business Card</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="16-co-branded-card-danish-merchants-only.html">1.6. Co-Branded card (Danish merchants only)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="2-saving-a-card.html">2. Saving a card</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="31-apple-pay-integration.html">3.1. Apple Pay Integration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="32-paypal-integration.html">3.2. PayPal Integration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="33-vipps-swish-mobilepay-integration.html">3.3. Vipps, Swish, MobilePay Integration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="34-finland---direct-bank-payment-via-paytrail.html">3.4. Finland - Direct bank payment (via Paytrail)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="4-ui-customization.html">4. UI Customization</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="51-error-codes-handling.html">5.1. Error Codes Handling</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="52-terminology.html">5.2. Terminology</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="53-faqs.html">5.3. FAQs</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="54-backend-tips.html">5.4. Backend Tips</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="6-limitations.html">6. Limitations</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="7-licenses.html">7. Licenses</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="8-changelog.html">8. Changelog</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="9-get-in-touch.html">9. Get in touch</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Categories.html">Categories</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Categories/NSError_28Wallets_29.html">NSError(Wallets)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CardDisplay.html">CardDisplay</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CardPayment.html">CardPayment</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CardPaymentProcess.html">CardPaymentProcess</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CardRegistrationResponse.html">CardRegistrationResponse</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CardStorage.html">CardStorage</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MerchantDetails.html">MerchantDetails</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIApplePayInfo.html">NPIApplePayInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIApplePayShippingInfo.html">NPIApplePayShippingInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIError.html">NPIError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIInterfaceConfiguration.html">NPIInterfaceConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIMerchantInfo.html">NPIMerchantInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIOrderInfo.html">NPIOrderInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPITokenCardInfo.html">NPITokenCardInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPITransactionInfo.html">NPITransactionInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PayPalPaymentProcess.html">PayPalPaymentProcess</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PayPalRegistrationResponse.html">PayPalRegistrationResponse</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PaymentProcess.html">PaymentProcess</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PaytrailPaymentProcess.html">PaytrailPaymentProcess</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PaytrailRegistrationResponse.html">PaytrailRegistrationResponse</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PiaSDK.html">PiaSDK</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PiaSDKController.html">PiaSDKController</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/RegistrationResponse.html">RegistrationResponse</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/TokenizedCardExpressCheckout.html">TokenizedCardExpressCheckout</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/TokenizedCardPayment.html">TokenizedCardPayment</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/TokenizedCardPrompt.html">TokenizedCardPrompt</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/TokenizedCardPromptConfirmation.html">TokenizedCardPromptConfirmation</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes.html#/c:objc(cs)TokenizedCardPromptNone">TokenizedCardPromptNone</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/WalletPaymentProcess.html">WalletPaymentProcess</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/WalletRegistrationResponse.html">WalletRegistrationResponse</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Constants.html">Constants</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@NPIPiaSemanticVersionString">NPIPiaSemanticVersionString</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@NPIPiaTechnicalVersionString">NPIPiaTechnicalVersionString</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@PiaVersionNumber">PiaVersionNumber</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@PiaVersionString">PiaVersionString</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/Card.html">Card</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/CardScheme.html">CardScheme</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PayButtonTextLabelOption.html">PayButtonTextLabelOption</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PiALanguage.html">PiALanguage</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/SchemeType.html">SchemeType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/Wallet.html">Wallet</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/WalletErrorCode.html">WalletErrorCode</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PaymentRegistering.html">PaymentRegistering</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PaymentRegistrationResult.html">PaymentRegistrationResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PiaSDKDelegate.html">PiaSDKDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PiaSDKTheme.html">PiaSDKTheme</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Type%20Definitions.html">Type Definitions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@CardError">CardError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@CardRegistrationCallback">CardRegistrationCallback</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@CompletionCallback">CompletionCallback</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentProcess.h@T@Currency">Currency</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@FailureCompletionCallback">FailureCompletionCallback</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions/NPIErrorCode.html">NPIErrorCode</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@PayPalRegistrationCallback">PayPalRegistrationCallback</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@PaymentProcessCompletion">PaymentProcessCompletion</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@PaymentProcessFailure">PaymentProcessFailure</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@PaytrailRegistrationCallback">PaytrailRegistrationCallback</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@RedirectURL">RedirectURL</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@TokenizableCardRegistrationCallback">TokenizableCardRegistrationCallback</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@TokenizeCardForLaterUse">TokenizeCardForLaterUse</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@TransactionCallback">TransactionCallback</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@TransactionCompletion">TransactionCompletion</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@TransactionID">TransactionID</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:NSError+Wallets.h@T@WalletError">WalletError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@WalletFailureWithError">WalletFailureWithError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@WalletRedirectWithoutInterruption">WalletRedirectWithoutInterruption</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@WalletURL">WalletURL</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type%20Definitions.html#/c:PaymentRegistration.h@T@WalletURLCallback">WalletURLCallback</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/c:@F@isSBusinessInitiated">isSBusinessInitiated</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content top-matter">
            
            <h1 id='saving-a-card' class='heading'>Saving a card</h1>

<p>Below you can find the interaction between the application that uses the <strong>PiA SDK</strong> and the SDK for <strong>Saving a card</strong>.</p>

<p><img src="./img/Register%20Flow.png" alt="Register Flow"></p>
<h2 id='the-save-card-logic-is-similar-to-em-basic-payment-flow-em-with-some-small-em-differences-em' class='heading'>The Save card logic is similar to <em>Basic payment flow</em>, with some small <em>differences</em>:</h2>

<p>You can start by creating a PaymentProcess object of type cardStorage.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">cardStorage</span> <span class="o">=</span> <span class="kt">PaymentProcess</span><span class="o">.</span><span class="nf">cardStorage</span><span class="p">(</span>
    <span class="nv">withMerchant</span><span class="p">:</span> <span class="n">merchantDetails</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">unowned</span> <span class="k">self</span><span class="p">]</span> <span class="n">callback</span> <span class="k">in</span>
          <span class="c1">// Make the registeration call here and retrun the callback</span>
    <span class="p">}</span>
</code></pre>

<p><em>Note:</em> If you do not support certain card schemes that are supported by the SDK, pass an exclude-card-scheme set to exclude the card schemes and present user with &ldquo;This card is not supported&rdquo; message during card entry. </p>
<pre class="highlight swift"><code><span class="c1">// Exclude Amex and Visa from supported card scheme list. </span>
<span class="k">let</span> <span class="nv">cardStorage</span> <span class="o">=</span> <span class="kt">PaymentProcess</span><span class="o">.</span><span class="nf">cardStorage</span><span class="p">(</span>
    <span class="nv">withMerchant</span><span class="p">:</span> <span class="n">merchantDetails</span><span class="p">,</span>
    <span class="nv">excludedCardSchemeSet</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="n">amex</span><span class="p">,</span> <span class="o">.</span><span class="n">visa</span><span class="p">])</span> <span class="p">{</span> <span class="p">[</span><span class="k">unowned</span> <span class="k">self</span><span class="p">]</span> <span class="n">callback</span> <span class="k">in</span>
           <span class="c1">// Make the registeration call here and retrun the callback</span>
     <span class="p">}</span>

</code></pre>

<p>Present the controller and handle the callbacks</p>
<pre class="highlight swift"><code>
<span class="kt">PiaSDK</span><span class="o">.</span><span class="nf">controller</span><span class="p">(</span>
    <span class="nv">for</span><span class="p">:</span> <span class="n">cardStorage</span><span class="p">,</span>                                     <span class="c1">// use cardStorage.sBusiness() for saving a S-Business Card</span>
    <span class="nv">success</span><span class="p">:</span> <span class="p">{</span> <span class="n">piaController</span><span class="p">,</span> <span class="n">transactionId</span> <span class="k">in</span>  <span class="p">},</span>        <span class="c1">// Commit the transaction with your merchant backend</span>
    <span class="nv">cancellation</span><span class="p">:</span> <span class="p">{</span> <span class="n">piaController</span><span class="p">,</span> <span class="n">transactionId</span> <span class="k">in</span> <span class="p">},</span>    <span class="c1">// User canceled, rollback the transaction</span>
    <span class="nv">failure</span><span class="p">:</span> <span class="p">{</span> <span class="n">piaController</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span><span class="p">}</span>                   <span class="c1">// Rollback transaction, check error object for detail. </span>
<span class="p">)</span>
</code></pre>
<h2 id='the-main-flow-for-saving-a-card' class='heading'>The main flow for saving a card:</h2>

<ul>
<li><p>Scan Credit Card screen is displayed. User can scan the card, to simplify the process, or can proceed to Manual Entry screen. After scanning successfully, user will be prompted to manual entry screen, with the fields pre-populated (card number and expiration date - if were detected by the Card.IO library), to check if the data is valid, and correct if necessary.</p></li>
<li><p>User fills the CVV/CVC, and clicks Save Card button.</p></li>
<li><p>3D Secure WebView is prompted (3DS authentication is performed unless it has been waived by your chosen card acquirer). Here user can navigate inside this web page, using custom build controls (Back, Forward, Close).</p></li>
<li><p>If user closes the webview, user will return to the manual entry page.</p></li>
<li><p>After filling the confirmation code in 3D Secure, the user is returned back to the application, with a result code that is handled by the SDK and appropriate callbacks are fired.</p></li>
</ul>

<p><strong>Note:</strong> Since card scanning functionality requires <em>Camera Permission</em>, the camera usage must be added to <em>Info.plist</em> file in the host application.</p>

<p><code>Key    :  Privacy - Camera Usage Description   
 Value  :  $(PRODUCT_NAME) camera us</code></p>

<p>For Netaxept Production environment, when saving a card and the 3D Secure process is triggered, this is handled inside the SDK, without storing any information related to the transaction.</p>

<p>The save card process consists in a payment towards Netaxept with 0 (zero) amount. However, when Netaxept processes this request, is forced to use the one major amount of the specific currency (e.g. for EUR currency, the major amount is 1 EUR).</p>

<p><strong>Note:</strong> This amount won&rsquo;t be charged to the user, this is for verifying purpose only due to the requirement from the issuer.</p>

<p><strong>Note:</strong> During the process, if users change the camera permission or any of the application&rsquo;s permissions, the application will be restarted automatically by the system (according to Apple&rsquo;s policy and security reason).</p>
<h5 id='netaxept-backend-integration-request-body-saving-em-card-em-for-em-easy-recurring-payment-em' class='heading'>Netaxept backend integration request body - Saving <em>card</em> for <em>Easy/Recurring Payment</em></h5>

<p>Note: See <a href="https://developers.nets.eu/netaxept/en-EU/api/rest-v1/#netaxept-queryaspx-get" title="Netaxept">Netaxept</a> documentation for more details on this API. </p>

<blockquote>
<p>Test: <a href="https://test.epayment.nets.eu">https://test.epayment.nets.eu</a>
Production: <a href="https://epayment.nets.eu">https://epayment.nets.eu</a>
Path:  <strong>/netaxept/register.aspx</strong>
Method: <strong><em>POST</em></strong></p>
</blockquote>

<p>Request body:</p>
<pre class="highlight swift"><code><span class="c1">// Saving card for Easy payment</span>
<span class="p">{</span>
    <span class="s">"merchantId"</span> <span class="p">:</span> <span class="s">"integer"</span><span class="p">,</span> 
    <span class="s">"token"</span> <span class="p">:</span> <span class="s">"string"</span><span class="p">,</span>
    <span class="s">"orderNumber"</span> <span class="p">:</span> <span class="s">"string"</span><span class="p">,</span>
    <span class="s">"currencyCode"</span> <span class="p">:</span> <span class="s">"string"</span><span class="p">,</span>  
    <span class="s">"redirectUrl"</span> <span class="p">:</span> <span class="s">"string"</span><span class="p">,</span>
    <span class="s">"serviceType"</span> <span class="p">:</span> <span class="s">"M"</span><span class="p">,</span>
    <span class="s">"recurringType"</span> <span class="p">:</span> <span class="s">"S"</span><span class="p">,</span>
    <span class="s">"force3DSecure"</span> <span class="p">:</span> <span class="s">"true"</span><span class="p">,</span>
    <span class="s">"updateStoredPaymentInfo"</span> <span class="p">:</span> <span class="s">"true"</span>
<span class="p">}</span> 

<span class="c1">// Saving card for Recurring payment</span>
<span class="p">{</span>
    <span class="s">"merchantId"</span> <span class="p">:</span> <span class="s">"integer"</span><span class="p">,</span>
    <span class="s">"token"</span> <span class="p">:</span> <span class="s">"string"</span><span class="p">,</span>
    <span class="s">"orderNumber"</span> <span class="p">:</span> <span class="s">"string"</span><span class="p">,</span>
    <span class="s">"currencyCode"</span> <span class="p">:</span> <span class="s">"string"</span><span class="p">,</span>
    <span class="s">"redirectUrl"</span> <span class="p">:</span> <span class="s">"string"</span><span class="p">,</span>
    <span class="s">"serviceType"</span> <span class="p">:</span> <span class="s">"M"</span><span class="p">,</span>
    <span class="s">"recurringType"</span> <span class="p">:</span> <span class="s">"R"</span><span class="p">,</span>
    <span class="s">"recurringExpiryDate"</span> <span class="p">:</span> <span class="s">"YYYYMMDD"</span><span class="p">,</span>
    <span class="s">"recurringFrequency"</span> <span class="p">:</span> <span class="s">"integer"</span><span class="p">,</span>
    <span class="s">"force3DSecure"</span> <span class="p">:</span> <span class="s">"true"</span><span class="p">,</span>
    <span class="s">"updateStoredPaymentInfo"</span> <span class="p">:</span> <span class="s">"true"</span>
<span class="p">}</span>
</code></pre>

<p>Netaxept returns transaction ID following the above register call. In order to store the card, make a verify API call to Netaxept with the given transaction ID.</p>

<p>(Query the status of the register call with Netaxept to retreive and store the Pan-hash associated with the card)</p>

<blockquote>
<p>Test: <a href="https://test.epayment.nets.eu">https://test.epayment.nets.eu</a>
Production: <a href="https://epayment.nets.eu">https://epayment.nets.eu</a>
Path:  <strong>/netaxept/process.aspx</strong>
Method: <strong><em>POST</em></strong></p>
</blockquote>

<p>Request body: </p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"merchantId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"token"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"transactionId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"operation"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"VERIFY"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Use the <em>query</em> API to fetch the Pan Hash associated with the card once process VERIFY is successful.</p>
<h3 id='query-transaction-status' class='heading'>Query transaction status</h3>

<blockquote>
<p>Test: <a href="https://test.epayment.nets.eu">https://test.epayment.nets.eu</a>
Production: <a href="https://epayment.nets.eu">https://epayment.nets.eu</a>
Path:  <strong>/netaxept/query.aspx</strong>
Method: <strong><em>POST</em></strong></p>
</blockquote>

<p>Request body: </p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"merchantId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"token"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"transactionId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Note: See <a href="https://developers.nets.eu/netaxept/en-EU/api/rest-v1/#netaxept-queryaspx-get" title="Netaxept">Netaxept</a> documentation for more details on this API. </p>

<p>Note: Netaxept backend integration tips can be found in <em>5.4 Backend Tips</em>,  <em>Easy/Recurring Payment</em> <a href="./54-backend-tips.html#registering-easy-Payment">section</a></p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2024 <a class="link" href="https://nets.eu" target="_blank" rel="external noopener">Nets</a>. All rights reserved. (Last updated: 2024-02-19)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external noopener">jazzy ♪♫ v0.14.3</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external noopener">Realm</a> project.</p>
    </section>
  </body>
</html>
