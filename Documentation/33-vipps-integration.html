<!DOCTYPE html>
<html lang="en">
  <head>
    <title>3.3. Vipps Integration  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="3.3. Vipps Integration  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          Pia Docs
        </a>
         (97% documented)
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">Pia Reference</a>
      <img class="carat" src="img/carat.png" />
      3.3. Vipps Integration  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="0-getting-started.html">0. Getting started</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="11-basic-payment-flow.html">1.1. Basic payment flow</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="12-easy-one-click-payment-flow.html">1.2. Easy (one click) payment flow</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="13-recurring-payments.html">1.3. Recurring payments</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="2-register-flow.html">2. Register flow</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="31-apple-pay-integration.html">3.1. Apple Pay Integration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="32-paypal-integration.html">3.2. PayPal Integration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="33-vipps-integration.html">3.3. Vipps Integration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="4-ui-customization.html">4. UI Customization</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="51-error-codes-handling.html">5.1. Error Codes Handling</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="52-terminology.html">5.2. Terminology</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="53-faqs.html">5.3. FAQs</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="54-backend-tips.html">5.4. Backend Tips</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="6-licenses.html">6. Licenses</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="7-changelog.html">7. Changelog</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="8-get-in-touch.html">8. Get in touch</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIApplePayInfo.html">NPIApplePayInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIApplePayShippingInfo.html">NPIApplePayShippingInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIError.html">NPIError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIInterfaceConfiguration.html">NPIInterfaceConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIMerchantInfo.html">NPIMerchantInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIOrderInfo.html">NPIOrderInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPITokenCardInfo.html">NPITokenCardInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPITransactionInfo.html">NPITransactionInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PiaSDK.html">PiaSDK</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PiaSDKController.html">PiaSDKController</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Constants.html">Constants</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@NPIPiaSemanticVersionString">NPIPiaSemanticVersionString</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@NPIPiaTechnicalVersionString">NPIPiaTechnicalVersionString</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@PiaVersionNumber">PiaVersionNumber</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@PiaVersionString">PiaVersionString</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PiALanguage.html">PiALanguage</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/SchemeType.html">SchemeType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PiaSDKDelegate.html">PiaSDKDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/VippsPaymentDelegate.html">VippsPaymentDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/WalletPaymentDelegate.html">WalletPaymentDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Type Definitions.html">Type Definitions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type Definitions/NPIErrorCode.html">NPIErrorCode</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type Definitions.html#/c:PiaSDK.h@T@VippsStatusCode">VippsStatusCode</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <h1 id='vipps-integration' class='heading'>Vipps Integration</h1>

<table><thead>
<tr>
<th style="text-align: center">Vipps Flow</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: center"><img src="./Resources/VippsFlow.gif" alt=""></td>
</tr>
</tbody></table>

<p>To initiate Vipps payment with <strong>Pia SDK</strong>, implement the <code><a href="Protocols/VippsPaymentDelegate.html">VippsPaymentDelegate</a></code> and trigger the process as follows:</p>
<pre class="highlight swift"><code><span class="c1">/// Initiating Vipps from a view controller that conforms to VippsPaymentDelegate.</span>
<span class="c1">/// The API returns false if Vipps app cannot be openned, e.g. uninstalled or missing</span>
<span class="c1">/// URL scheme in info.plist of your application. </span>
<span class="c1">/// - Note: The `sender` view controller is optionally passed to</span>
<span class="c1">///         display a transition view (an activity indicator)  </span>
<span class="c1">///         during the transition to and from Vipps app.</span>
<span class="k">guard</span> <span class="kt">PiaSDK</span><span class="o">.</span><span class="nf">initiateVipps</span><span class="p">(</span><span class="nv">fromSender</span><span class="p">:</span> <span class="k">self</span><span class="p">,</span> <span class="nv">delegate</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Vipps is not installed, preferably lead user to other payment methods</span>
    <span class="k">return</span>
<span class="p">}</span>
</code></pre>

<p><strong>Vipps App Detection</strong></p>

<p>The SDK checks if Vipps can be launched as the first step in the process preventing unnecessary payment registration. If Vipps app is not installed on user&rsquo;s device, we recommend leading user to other available payment methods.
The SDK throws <code>wallet app not installed</code> error in the corner case where user uninstalls Vipps app after payment has been registered with merchant backend.</p>

<p><strong>Note:</strong> In order for the PiA SDK to perform app detection, you need to add <code>vipps</code> under the <code>LSApplicationQueriesSchemes</code> key in your <strong>Info.plist</strong> file. If you skip this step, the PiA SDK will always return <code>wallet app cannot open</code> error even though you have the Vipps app installed on your device. </p>
<pre class="highlight plaintext"><code>&lt;key&gt;LSApplicationQueriesSchemes&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;vipps&lt;/string&gt;
&lt;/array&gt;
</code></pre>

<p>Here is the flow diagram for Vipps payment:</p>

<p><img src="./img/Vipps%20Payment%20Flow.png" alt="Vipps Payment Flow"></p>

<p><strong>Initializing a payment with Vipps:</strong></p>

<ul>
<li>The SDK will notify the app when it needs to register the payment via <code><a href="Protocols/VippsPaymentDelegate.html">VippsPaymentDelegate</a></code>. The app should register payment with merchant backend and return the wallet URL in the completion handler.</li>
<li>The <code>redirectUrl</code> has to be the merchant app scheme url followed by piasdk as the host <code>YOUR_APP_SCHEME_URL://piasdk</code>)</li>
<li>Provide customer&rsquo;s phone number in the following format: (Norwegian prefix): <code>phoneNumber = +4711111111</code> which must be URL encoded.</li>
<li>Vipps supports <strong>AUTH+CAPTURE</strong> process. If <strong>autoSale</strong> is set to <q>true</q>, Netaxept authorises and immediately captures the amount set in the <strong>REGISTER</strong> call. It is optional and default value is false (authorisation only and capture from the backend with additional process call).</li>
</ul>

<p>The following code shows how Vipps payment registration is handled in the sample app:</p>
<pre class="highlight swift"><code>    <span class="kd">extension</span> <span class="kt">PaymentMethodViewController</span> <span class="p">:</span> <span class="kt">VippsPaymentDelegate</span> <span class="p">{</span>
        <span class="kd">func</span> <span class="nf">registerVippsPayment</span><span class="p">(</span><span class="n">_</span> <span class="nv">completionWithWalletURL</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">String</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
            <span class="nf">postRegisterPayment</span><span class="p">(</span><span class="nv">storeCard</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">paymentData</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">mobileWallet</span><span class="p">:</span> <span class="o">.</span><span class="n">vipps</span><span class="p">)</span> <span class="p">{</span>
                <span class="nf">completionWithWalletURL</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">transactionInfo</span><span class="p">?</span><span class="o">.</span><span class="n">walletUrl</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kd">func</span> <span class="nf">postRegisterPayment</span><span class="p">(</span><span class="nv">storeCard</span><span class="p">:</span><span class="kt">Bool</span><span class="p">,</span> <span class="nv">paymentData</span><span class="p">:</span> <span class="kt">PKPaymentToken</span><span class="p">?,</span> <span class="nv">payPalPayment</span><span class="p">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">mobileWallet</span><span class="p">:</span> <span class="kt">MobileWallet</span> <span class="o">=</span> <span class="kt">None</span> <span class="p">,</span> <span class="nv">completed</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">orderNumber</span> <span class="o">=</span> <span class="s">"your unique order identifier"</span>
            <span class="k">var</span> <span class="nv">method</span><span class="p">:</span><span class="kt">Method</span> <span class="o">=</span> <span class="kt">Method</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"Vipps"</span><span class="p">,</span> <span class="nv">displayName</span><span class="p">:</span> <span class="s">"Vipps"</span><span class="p">,</span> <span class="nv">fee</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">let</span> <span class="nv">customerId</span> <span class="o">=</span> <span class="s">"your unique customer id"</span>
            <span class="k">var</span> <span class="nv">phoneNumber</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"YOUR PHONE NUMBER"</span>
            <span class="k">var</span> <span class="nv">redirectURL</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"YOUR_APP_SCHEME_URL://piasdk"</span>

            <span class="k">let</span> <span class="nv">parameter</span> <span class="o">=</span> <span class="kt">PaymentRegisterRequest</span><span class="p">(</span><span class="nv">customerId</span><span class="p">:</span> <span class="n">customerId</span><span class="p">,</span> <span class="nv">orderNumber</span><span class="p">:</span> <span class="n">orderNumber</span><span class="p">,</span> <span class="nv">amount</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">amount</span><span class="p">,</span> <span class="nv">method</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span> <span class="nv">cardId</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">token</span><span class="p">,</span> <span class="nv">storeCard</span><span class="p">:</span> <span class="n">storeCard</span><span class="p">,</span> <span class="nv">items</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">paymentData</span><span class="p">:</span> <span class="n">paymentDataString</span><span class="p">,</span> <span class="nv">phoneNumber</span><span class="p">:</span> <span class="n">phoneNumber</span><span class="p">,</span> <span class="nv">redirectURL</span><span class="p">:</span> <span class="n">redirectURL</span><span class="p">)</span>

            <span class="kt">RequestManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">postRegister</span><span class="p">(</span><span class="nv">parameters</span><span class="p">:</span> <span class="n">params</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
                <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
                <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">res</span><span class="p">):</span>
                    <span class="nf">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">transactionInfo</span> <span class="o">=</span> <span class="kt">NPITransactionInfo</span><span class="p">(</span><span class="nv">transactionID</span><span class="p">:</span> <span class="n">res</span><span class="o">.</span><span class="n">transactionId</span><span class="p">,</span> <span class="nv">walletUrl</span><span class="p">:</span> <span class="n">res</span><span class="o">.</span><span class="n">walletUrl</span><span class="p">)</span>
                    <span class="nf">completed</span><span class="p">()</span>
                <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">err</span><span class="p">):</span>
                    <span class="nf">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                    <span class="nf">completed</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre>

<p><strong>Launching Vipps App:</strong> </p>

<p>After registering the Vipps payment method and generating the <code>transaction Id</code> and <code>walletUrl</code> the PiA SDK will try to launch the Vipps app.</p>

<p><strong>Note:</strong> Vipps gives users 5 minutes to complete payment before the session expires. In case of a time-out, the merchant backend needs to make a Netaxept Query call to get the transaction status.</p>

<p>After the transaction is performed inside the Vipps application, Vipps redirects user to the merchant app via <code>open(_ url:options:completionHandler) -&gt; Bool</code> method of <code>UIApplication</code>. The merchant app needs to notify the SDK using the API <code>PiaSDK.applicationDidOpenFromRedirect(with: url, andOptions: options)</code>. 
From security perspective, to avoid any malicious attack, Apple recommends to validate the URL before allowing it to open the current app. For this, the merchant app can validate if the sourceApplication is a valid app. In case of Vipps, the sourceApplication can be validated against:</p>

<ul>
<li><code>no.dnb.vipps</code>(production)</li>
<li><code>no.vipps.internal.mt.vipps</code>(test).</li>
</ul>

<p>You can further refer to <a href="https://developer.apple.com/documentation/uikit/inter-process_communication/allowing_apps_and_websites_to_link_to_your_content/defining_a_custom_url_scheme_for_your_app">Handle Incoming URLs</a> from the Apple documentation.</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">app</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">open</span> <span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[</span><span class="kt">UIApplicationOpenURLOptionsKey</span> <span class="p">:</span> <span class="kt">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">[:])</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
    <span class="cm">/*
     The Vipps app will return the status of the transaction in the url.
     The merchant app needs to fire the below notification with this url in the userInfo dict
     so that the SDK can parse it and return the appropriate success/error status to the merchant app.

     If you have both the official Vipps app from App Store and the test Vipps app from TestFlight
     installed, the app switch may open either one. There is no way to open one of them specifically,
     as the URL scheme is the same for both. A workaround is to only have one of the apps installed on the device.
    */</span>

    <span class="kd">enum</span> <span class="kt">VippsAppID</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CaseIterable</span> <span class="p">{</span>
        <span class="c1">/// Vipps production app - "no.dnb.vipps"</span>
        <span class="k">case</span> <span class="n">production</span> <span class="o">=</span> <span class="s">"no.dnb.vipps"</span>
        <span class="c1">/// Vipps test app - "no.vipps.internal.mt.vipps"</span>
        <span class="k">case</span> <span class="n">test</span> <span class="o">=</span> <span class="s">"no.vipps.internal.mt.vipps"</span>
    <span class="p">}</span>

    <span class="c1">/// Handle redirects from Vipps App</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">sendingAppID</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="o">.</span><span class="n">sourceApplication</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span>
        <span class="kt">VippsAppID</span><span class="p">(</span><span class="nv">rawValue</span><span class="p">:</span> <span class="n">sendingAppID</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="kt">PiaSDK</span><span class="o">.</span><span class="nf">applicationDidOpenFromRedirect</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span> <span class="nv">andOptions</span><span class="p">:</span> <span class="n">options</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">true</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">false</span>
<span class="p">}</span>
</code></pre>

<p>The SDK will parse the redirect URL and notifies the delegate of successful, failed or interrupted result. The following code shows implementation of <code><a href="Protocols/VippsPaymentDelegate.html">VippsPaymentDelegate</a></code> in the sample app:</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">PaymentMethodViewController</span><span class="p">:</span> <span class="kt">VippsPaymentDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">registerVippsPayment</span><span class="p">(</span><span class="n">_</span> <span class="nv">completionWithWalletURL</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">String</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">postRegisterPayment</span><span class="p">(</span><span class="nv">storeCard</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">paymentData</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">mobileWallet</span><span class="p">:</span> <span class="o">.</span><span class="kt">Vipps</span><span class="p">)</span> <span class="p">{</span>
            <span class="nf">completionWithWalletURL</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="n">transactionInfo</span><span class="p">?</span><span class="o">.</span><span class="n">walletUrl</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">walletPaymentDidSucceed</span><span class="p">(</span><span class="n">_</span> <span class="nv">transitionIndicatorView</span><span class="p">:</span> <span class="kt">UIView</span><span class="p">?)</span> <span class="p">{</span>
        <span class="nf">commitCall</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">walletPaymentInterrupted</span><span class="p">(</span><span class="n">_</span> <span class="nv">transitionIndicatorView</span><span class="p">:</span> <span class="kt">UIView</span><span class="p">?)</span> <span class="p">{</span>
        <span class="nf">prepareForResultViewController</span><span class="p">(</span><span class="nv">result</span><span class="p">:</span> <span class="o">.</span><span class="n">cancelled</span><span class="p">)</span>
        <span class="nf">dismiss</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">vippsPaymentDidFail</span><span class="p">(</span><span class="n">with</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NPIError</span><span class="p">,</span> <span class="nv">vippsStatusCode</span><span class="p">:</span> <span class="kt">VippsStatusCode</span><span class="p">?)</span> <span class="p">{</span>
        <span class="nf">prepareForResultViewController</span><span class="p">(</span><span class="nv">result</span><span class="p">:</span> <span class="o">.</span><span class="nf">error</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
        <span class="nf">dismiss</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre>

<p>Vipps application returns success and failure status codes. The Vipps status code is passed to the application in case of failed process.</p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2019 <a class="link" href="https://nets.eu" target="_blank" rel="external">Nets</a>. All rights reserved. (Last updated: 2019-09-19)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.0</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
