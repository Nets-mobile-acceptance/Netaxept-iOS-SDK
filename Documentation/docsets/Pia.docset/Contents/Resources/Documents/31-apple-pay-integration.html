<!DOCTYPE html>
<html lang="en">
  <head>
    <title>3.1. Apple Pay Integration  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="3.1. Apple Pay Integration  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          Pia Docs
        </a>
         (97% documented)
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">Pia Reference</a>
      <img class="carat" src="img/carat.png" />
      3.1. Apple Pay Integration  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="0-getting-started.html">0. Getting started</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="11-basic-payment-flow.html">1.1. Basic payment flow</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="12-easy-one-click-payment-flow.html">1.2. Easy (one click) payment flow</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="13-easy-payment-without-cvv.html">1.3. Easy payment without CVV</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="2-register-flow.html">2. Register flow</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="31-apple-pay-integration.html">3.1. Apple Pay Integration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="32-paypal-integration.html">3.2. PayPal Integration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="4-ui-customization.html">4. UI Customization</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="51-error-codes-handling.html">5.1. Error Codes Handling</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="52-terminology.html">5.2. Terminology</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="6-licenses.html">6. Licenses</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="7-changelog.html">7. Changelog</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="8-get-in-touch.html">8. Get in touch</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIApplePayInfo.html">NPIApplePayInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIApplePayShippingInfo.html">NPIApplePayShippingInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIError.html">NPIError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIInterfaceConfiguration.html">NPIInterfaceConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIMerchantInfo.html">NPIMerchantInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPIOrderInfo.html">NPIOrderInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPITokenCardInfo.html">NPITokenCardInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NPITransactionInfo.html">NPITransactionInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PiaSDKController.html">PiaSDKController</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Constants.html">Constants</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@NPIPiaSemanticVersionString">NPIPiaSemanticVersionString</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@NPIPiaTechnicalVersionString">NPIPiaTechnicalVersionString</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@PiaVersionNumber">PiaVersionNumber</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Constants.html#/c:@PiaVersionString">PiaVersionString</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/SchemeType.html">SchemeType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/PiaSDKDelegate.html">PiaSDKDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Type Definitions.html">Type Definitions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Type Definitions/NPIErrorCode.html">NPIErrorCode</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <h1 id='apple-pay-integration' class='heading'>Apple Pay Integration</h1>
<h2 id='prerequisite' class='heading'>Prerequisite</h2>

<ul>
<li>Get Apple Pay certificate with Netaxept CSR file</li>
<li>Merchant account can make payment with Apple Pay</li>
<li>Get merchant ID from Apple for Apple Pay</li>
</ul>

<p>For further information about getting Netaxept CSR certificate, please refer to the below files:</p>

<p><a href="Resources/ApplePayFlow.pptx">Netaxept - Apple Pay Payment Flow</a></p>

<p><a href="Resources/Netaxept_ApplePay_GetStartedGuide_EN_V0.45.pdf">Netaxept - Apple Pay Integration doc</a></p>
<h2 id='step-by-step-process' class='heading'>Step-by-step process</h2>

<ol>
<li>In your <a href="http://developer.apple.com/">Apple Developer Account</a> site,  get your Merchant ID (not your Netaxept Merchant ID).</li>
<li>In your <a href="https://epayment.nets.eu/admin">Netaxept ADMIN</a> site, get Apple Pay certificate by following instructions there.</li>
<li>In your project, enable Apple Pay capability with the correct Apple Pay Merchant ID you just created.</li>
<li>Navigate to where you store Apple Pay certificate gotten from 1st step, double click to enable your keychain.</li>
<li>Getting started with below instructions.</li>
</ol>
<h2 id='apple-pay-normal-checkout-and-express-checkout-overview' class='heading'>Apple Pay - Normal Checkout and Express Checkout overview</h2>

<table><thead>
<tr>
<th style="text-align: center">Normal Checkout</th>
<th style="text-align: center">Express Checkout</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: center"><img src="./Resources/Normal.gif" alt=""></td>
<td style="text-align: center"><img src="./Resources/Express.gif" alt=""></td>
</tr>
</tbody></table>
<h2 id='apple-pay-normal-checkout-with-pia-sdk' class='heading'>Apple Pay (Normal Checkout) with PiA SDK</h2>

<p>Apple Pay transaction flow is similar to other card schemes&rsquo; flows with <strong>PiA SDK</strong>. Thus, in order to initialize Apple Pay transaction <code><a href="Classes/PiaSDKController.html">PiaSDKController</a></code> should be instantiated with the following parameters:</p>

<ul>
<li><code><a href="Classes/NPIApplePayInfo.html">NPIApplePayInfo</a></code> - Required information for Apple Pay transaction</li>
</ul>

<p>The code snippet below is the minimum requirement for Apple Pay:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">applePayMerchantID</span> <span class="o">=</span> <span class="s">"YOUR APPLE PAY MERCHANT ID"</span>
<span class="k">let</span> <span class="nv">applePayItemDisplayName</span> <span class="o">=</span> <span class="s">"YOUR ITEM/ORDER NAME"</span>
<span class="k">let</span> <span class="nv">applePayMerchantDisplayName</span> <span class="o">=</span> <span class="s">"YOUR MERCHANT DISPLAY NAME"</span>
<span class="k">let</span> <span class="nv">applePayItemCost</span> <span class="o">=</span> <span class="kt">NSDecimalNumber</span><span class="p">(</span><span class="nv">value</span><span class="p">:</span> <span class="mi">8</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">applePayItemShippingCost</span> <span class="o">=</span> <span class="kt">NSDecimalNumber</span><span class="p">(</span><span class="nv">value</span><span class="p">:</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">currencyCode</span> <span class="o">=</span> <span class="s">"EUR"</span>

<span class="k">let</span> <span class="nv">applePayInfo</span> <span class="o">=</span> <span class="kt">NPIApplePayInfo</span><span class="p">(</span><span class="nv">applePayMerchantID</span><span class="p">:</span> <span class="n">applePayMerchantID</span><span class="p">,</span> <span class="nv">applePayItemDisplayName</span><span class="p">:</span> <span class="n">applePayItemDisplayName</span><span class="p">,</span> <span class="nv">applePayMerchantDisplayName</span><span class="p">:</span> <span class="n">applePayMerchantDisplayName</span><span class="p">,</span> <span class="nv">applePayItemCost</span><span class="p">:</span> <span class="n">applePayItemCost</span><span class="p">,</span> <span class="nv">applePayItemShippingCost</span><span class="p">:</span> <span class="n">applePayItemShippingCost</span><span class="p">,</span> <span class="nv">currencyCode</span><span class="p">:</span> <span class="n">currencyCode</span><span class="p">,</span> <span class="nv">applePayShippingInfo</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">usingExpressCheckout</span><span class="p">:</span> <span class="kc">false</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">piaSDK</span> <span class="o">=</span> <span class="kt">PiaSDKController</span><span class="p">(</span><span class="nv">merchantInfo</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">orderInfo</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">tokenCardInfo</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">applePayInfo</span><span class="p">:</span> <span class="n">applePayInfo</span><span class="p">)</span>
<span class="n">piaSDK</span><span class="o">.</span><span class="n">piaDelegate</span> <span class="o">=</span> <span class="k">self</span>

<span class="k">self</span><span class="o">.</span><span class="nf">present</span><span class="p">(</span><span class="n">piaSDK</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre>

<p>Besides, <strong>PiA SDK</strong> can support shipping information <code><a href="Classes/NPIApplePayShippingInfo.html">NPIApplePayShippingInfo</a></code> if your order needs shipping information from users.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">shippingAddress</span> <span class="o">=</span> <span class="kt">CNMutablePostalAddress</span><span class="p">()</span>
<span class="n">shippingAddress</span><span class="o">.</span><span class="n">city</span> <span class="o">=</span> <span class="s">"YOUR CITY"</span>
<span class="n">shippingAddress</span><span class="o">.</span><span class="n">country</span> <span class="o">=</span> <span class="s">"YOUR COUNTRY"</span>
<span class="n">shippingAddress</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s">"YOUR STATE"</span>
<span class="n">shippingAddress</span><span class="o">.</span><span class="n">postalCode</span> <span class="o">=</span> <span class="s">"YOUR POSTAL CODE"</span>
<span class="n">shippingAddress</span><span class="o">.</span><span class="n">street</span> <span class="o">=</span> <span class="s">"YOUR STREET ADDRESS"</span>

<span class="k">let</span> <span class="nv">fullName</span> <span class="o">=</span> <span class="kt">NSPersonNameComponents</span><span class="p">()</span>
<span class="n">fullName</span><span class="o">.</span><span class="n">familyName</span> <span class="o">=</span> <span class="s">"YOUR FAMILY NAME"</span>
<span class="n">fullName</span><span class="o">.</span><span class="n">givenName</span> <span class="o">=</span> <span class="s">"YOUR FIRST NAME"</span>

<span class="k">let</span> <span class="nv">phoneNumber</span> <span class="o">=</span> <span class="kt">CNPhoneNumber</span><span class="p">(</span><span class="nv">stringValue</span><span class="p">:</span> <span class="s">"YOUR PHONE NUMBER"</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">email</span> <span class="o">=</span> <span class="s">"YOUR EMAIL"</span>

<span class="k">let</span> <span class="nv">applePayShippingInfo</span> <span class="o">=</span> <span class="kt">NPIApplePayShippingInfo</span><span class="p">(</span><span class="nv">shippingAddress</span><span class="p">:</span> <span class="n">shippingAddress</span><span class="p">,</span> <span class="nv">fullName</span><span class="p">:</span> <span class="n">fullName</span> <span class="k">as</span> <span class="kt">PersonNameComponents</span><span class="p">,</span> <span class="nv">email</span><span class="p">:</span> <span class="n">email</span><span class="p">,</span> <span class="nv">phoneNumber</span><span class="p">:</span> <span class="n">phoneNumber</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">applePayMerchantID</span> <span class="o">=</span> <span class="s">"YOUR APPLE PAY MERCHANT ID"</span>
<span class="k">let</span> <span class="nv">applePayItemDisplayName</span> <span class="o">=</span> <span class="s">"YOUR ITEM/ORDER NAME"</span>
<span class="k">let</span> <span class="nv">applePayMerchantDisplayName</span> <span class="o">=</span> <span class="s">"YOUR MERCHANT DISPLAY NAME"</span>
<span class="k">let</span> <span class="nv">applePayItemCost</span> <span class="o">=</span> <span class="kt">NSDecimalNumber</span><span class="p">(</span><span class="nv">value</span><span class="p">:</span> <span class="mi">8</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">applePayItemShippingCost</span> <span class="o">=</span> <span class="kt">NSDecimalNumber</span><span class="p">(</span><span class="nv">value</span><span class="p">:</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">currencyCode</span> <span class="o">=</span> <span class="s">"EUR"</span>                

<span class="k">let</span> <span class="nv">applePayInfo</span> <span class="o">=</span> <span class="kt">NPIApplePayInfo</span><span class="p">(</span><span class="nv">applePayMerchantID</span><span class="p">:</span> <span class="n">applePayMerchantID</span><span class="p">,</span> <span class="nv">applePayItemDisplayName</span><span class="p">:</span> <span class="n">applePayItemDisplayName</span><span class="p">,</span> <span class="nv">applePayMerchantDisplayName</span><span class="p">:</span> <span class="n">applePayMerchantDisplayName</span><span class="p">,</span> <span class="nv">applePayItemCost</span><span class="p">:</span> <span class="n">applePayItemCost</span><span class="p">,</span> <span class="nv">applePayItemShippingCost</span><span class="p">:</span> <span class="n">applePayItemShippingCost</span><span class="p">,</span> <span class="nv">currencyCode</span><span class="p">:</span> <span class="n">currencyCode</span><span class="p">,</span> <span class="nv">applePayShippingInfo</span><span class="p">:</span> <span class="n">applePayShippingInfo</span><span class="p">,</span> <span class="nv">usingExpressCheckout</span><span class="p">:</span> <span class="kc">false</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">piaSDK</span> <span class="o">=</span> <span class="kt">PiaSDKController</span><span class="p">(</span><span class="nv">merchantInfo</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">orderInfo</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">tokenCardInfo</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">applePayInfo</span><span class="p">:</span> <span class="n">applePayInfo</span><span class="p">)</span>
<span class="n">piaSDK</span><span class="o">.</span><span class="n">piaDelegate</span> <span class="o">=</span> <span class="k">self</span>

<span class="k">self</span><span class="o">.</span><span class="nf">present</span><span class="p">(</span><span class="n">piaSDK</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre>
<h2 id='apple-pay-express-checkout-with-pia-sdk' class='heading'>Apple Pay (Express Checkout) with PiA SDK</h2>

<p>The mentioned above flow is the <strong>Normal Checkout</strong> with Apple Pay provided by <strong>PiA SDK</strong>. However, <strong>PiA SDK</strong> also provides one extra fast checkout flow, <strong>Express Checkout</strong>. If you wish to use the Express Checkout for Apple Pay, set this variable <code>usingExpressCheckout</code> to <strong>true</strong>.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">applePayInfo</span> <span class="o">=</span> <span class="kt">NPIApplePayInfo</span><span class="p">(</span><span class="nv">applePayMerchantID</span><span class="p">:</span> <span class="n">applePayMerchantID</span><span class="p">,</span> <span class="nv">applePayItemDisplayName</span><span class="p">:</span> <span class="n">applePayItemDisplayName</span><span class="p">,</span> <span class="nv">applePayMerchantDisplayName</span><span class="p">:</span> <span class="n">applePayMerchantDisplayName</span><span class="p">,</span> <span class="nv">applePayItemCost</span><span class="p">:</span> <span class="n">applePayItemCost</span><span class="p">,</span> <span class="nv">applePayItemShippingCost</span><span class="p">:</span> <span class="n">applePayItemShippingCost</span><span class="p">,</span> <span class="nv">currencyCode</span><span class="p">:</span> <span class="n">currencyCode</span><span class="p">,</span> <span class="nv">applePayShippingInfo</span><span class="p">:</span> <span class="n">applePayShippingInfo</span><span class="p">,</span> <span class="nv">usingExpressCheckout</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
</code></pre>
<h2 id='delegation' class='heading'>Delegation</h2>

<p>As mentioned above, Apple Pay transaction will be handled as other cards&rsquo; transaction. The below list is the delegations you need to conform for Apple Pay transaction:</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">registerPayment</span><span class="p">(</span><span class="n">withApplePayData</span> <span class="kt">PiaSDKController</span><span class="p">:</span> <span class="kt">PiaSDKController</span><span class="p">,</span> <span class="nv">paymentData</span><span class="p">:</span> <span class="kt">PKPaymentToken</span><span class="p">,</span> <span class="nv">newShippingContact</span><span class="p">:</span> <span class="kt">PKContact</span><span class="p">?,</span> <span class="n">withCompletion</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">NPITransactionInfo</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span>

<span class="kd">func</span> <span class="nf">piaSDK</span><span class="p">(</span><span class="n">_</span> <span class="kt">PiaSDK</span><span class="p">:</span> <span class="kt">PiaSDKController</span><span class="p">,</span> <span class="n">didFailWithError</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">NPIError</span><span class="p">)</span>

<span class="kd">func</span> <span class="nf">piaSDKDidComplete</span><span class="p">(</span><span class="n">withSuccess</span> <span class="kt">PiaSDK</span><span class="p">:</span> <span class="kt">PiaSDKController</span><span class="p">)</span>

<span class="kd">func</span> <span class="nf">piaSDKDidCancel</span><span class="p">(</span><span class="n">_</span> <span class="kt">PiaSDK</span><span class="p">:</span> <span class="kt">PiaSDKController</span><span class="p">)</span>
</code></pre>

<p><strong>NOTE:</strong> If you wish to support Shipping Address with Apple Pay, remember to conform to this (optional) delegate.</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">piaSDK</span><span class="p">(</span><span class="n">_</span> <span class="kt">PiaSDKController</span><span class="p">:</span> <span class="kt">PiaSDKController</span><span class="p">,</span> <span class="n">didChangeApplePayShippingContact</span> <span class="nv">contact</span><span class="p">:</span> <span class="kt">PKContact</span><span class="p">,</span> <span class="n">withCompletion</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Bool</span><span class="p">,</span> <span class="kt">NSDecimalNumber</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span>
</code></pre>

<p>Besides, if you allow the changes for Shipping Address from users, the new full address of users will be returned in <strong>registerPayment delegate</strong> <em>ONLY IF users authorized themselves with Apple Pay</em>.</p>
<h2 id='processing-apple-pay-payment-token-example' class='heading'>Processing Apple Pay Payment Token (example)</h2>

<p>As stated in the <strong>Delegation</strong> section, you will need to send Apple Pay Payment Token within your register call. Below is an example how you can process and send a working Apple Pay Payment Token:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">paymentDataDictionary</span><span class="p">:</span> <span class="p">[</span><span class="kt">AnyHashable</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]?</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="kt">JSONSerialization</span><span class="o">.</span><span class="nf">jsonObject</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">paymentData</span><span class="o">.</span><span class="n">paymentData</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="o">.</span><span class="n">mutableContainers</span><span class="p">)</span> <span class="k">as!</span> <span class="p">[</span><span class="kt">AnyHashable</span> <span class="p">:</span> <span class="kt">Any</span><span class="p">]</span>

<span class="k">var</span> <span class="nv">paymentType</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"debit"</span>

<span class="k">switch</span> <span class="n">paymentData</span><span class="o">.</span><span class="n">paymentMethod</span><span class="o">.</span><span class="n">type</span> <span class="p">{</span>
<span class="k">case</span> <span class="o">.</span><span class="nv">debit</span><span class="p">:</span>
    <span class="n">paymentType</span> <span class="o">=</span> <span class="s">"debit"</span>
<span class="k">case</span> <span class="o">.</span><span class="nv">credit</span><span class="p">:</span>
    <span class="n">paymentType</span> <span class="o">=</span> <span class="s">"credit"</span>
<span class="k">case</span> <span class="o">.</span><span class="nv">store</span><span class="p">:</span>
    <span class="n">paymentType</span> <span class="o">=</span> <span class="s">"store"</span>
<span class="k">case</span> <span class="o">.</span><span class="nv">prepaid</span><span class="p">:</span>
    <span class="n">paymentType</span> <span class="o">=</span> <span class="s">"prepaid"</span>
<span class="k">default</span><span class="p">:</span>
    <span class="n">paymentType</span> <span class="o">=</span> <span class="s">"unknown"</span>
<span class="p">}</span>

<span class="k">var</span> <span class="nv">paymentMethodDictionary</span><span class="p">:</span> <span class="p">[</span><span class="kt">AnyHashable</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">"network"</span><span class="p">:</span> <span class="s">""</span><span class="p">,</span> <span class="s">"type"</span><span class="p">:</span> <span class="n">paymentType</span><span class="p">,</span> <span class="s">"displayName"</span><span class="p">:</span> <span class="s">""</span><span class="p">]</span>

<span class="n">paymentMethodDictionary</span> <span class="o">=</span> <span class="p">[</span><span class="s">"network"</span><span class="p">:</span> <span class="n">paymentData</span><span class="o">.</span><span class="n">paymentMethod</span><span class="o">.</span><span class="n">network</span> <span class="p">??</span> <span class="s">""</span><span class="p">,</span> <span class="s">"type"</span><span class="p">:</span> <span class="n">paymentType</span><span class="p">,</span> <span class="s">"displayName"</span><span class="p">:</span> <span class="n">paymentData</span><span class="o">.</span><span class="n">paymentMethod</span><span class="o">.</span><span class="n">displayName</span> <span class="p">??</span> <span class="s">""</span><span class="p">]</span>

<span class="k">let</span> <span class="nv">cryptogramDictionary</span><span class="p">:</span> <span class="p">[</span><span class="kt">AnyHashable</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">"paymentData"</span><span class="p">:</span> <span class="n">paymentDataDictionary</span> <span class="p">??</span> <span class="s">""</span><span class="p">,</span> <span class="s">"transactionIdentifier"</span><span class="p">:</span> <span class="n">paymentData</span><span class="o">.</span><span class="n">transactionIdentifier</span><span class="p">,</span> <span class="s">"paymentMethod"</span><span class="p">:</span> <span class="n">paymentMethodDictionary</span><span class="p">]</span>

<span class="k">let</span> <span class="nv">cardCryptogramPacketDictionary</span><span class="p">:</span> <span class="p">[</span><span class="kt">AnyHashable</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">cryptogramDictionary</span>
<span class="k">let</span> <span class="nv">cardCryptogramPacketData</span><span class="p">:</span> <span class="kt">Data</span><span class="p">?</span> <span class="o">=</span> <span class="k">try</span><span class="p">?</span> <span class="kt">JSONSerialization</span><span class="o">.</span><span class="nf">data</span><span class="p">(</span><span class="nv">withJSONObject</span><span class="p">:</span> <span class="n">cardCryptogramPacketDictionary</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="p">[])</span>

<span class="k">let</span> <span class="nv">cardCryptogramPacketString</span> <span class="o">=</span> <span class="kt">String</span><span class="p">(</span><span class="nv">data</span><span class="p">:</span> <span class="n">cardCryptogramPacketData</span><span class="p">?,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span>
</code></pre>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2018 <a class="link" href="https://nets.eu" target="_blank" rel="external">Nets</a>. All rights reserved. (Last updated: 2018-12-18)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.0</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
